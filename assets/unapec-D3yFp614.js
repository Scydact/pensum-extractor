import{y as f}from"./index-BDbRlom9.js";const h="https://apiestudiante.azurewebsites.net/pensum/";async function w(o,p=h){let t=p+o.toUpperCase();const s=JSON.parse(localStorage.getItem("PENSUM_CORSPROXY")??'""');s&&(t=s+t),console.log("Fetching URL ",t);const c=await fetch(t).then(e=>e.json());try{return g(c,t,o)}catch(e){return console.warn(`Failed to extract pensum: ${e}`),null}}function g(o,p,t){if(!Array.isArray(o))throw new Error("Response must be an array");if(!o.length)throw new Error("Pensum has no registered Mats; is the pensum code valid?");const s=f(new Date),c={version:+"5.0",institution:"unapec",career:"",code:t.toUpperCase(),publishDate:"",fetchDate:s,info:[],src:{type:"fetch",url:p,date:s},periodType:{name:"Cuatrimestre",abbr:"Cuat",two:"Ct"},loose:[],periods:[],additionalPeriods:{}},e=[];for(const r of o){const[l,...u]=r.prerequisito.split("-"),d=l.split(",").map(i=>i.trim()).filter(Boolean),m=u.join("-").split(",").map(i=>i.trim()).filter(Boolean).map(i=>({text:i})),a={code:r.codigo_asignatura,cr:parseInt(r.creditos),name:r.asignatura,req:[...d,...m]},n=parseInt(r.cuatrimestre.split(" ").slice(-1)[0])-1;e[n]||(e[n]={}),a.code in e[n]&&console.log("Mat already exists!",{period:n,existing:e[n][a.code],new:a}),e[n][a.code]=a}return c.periods=e.filter(Boolean).map(r=>Object.values(r)),c}export{w as default,g as extractPensum};
